<!DOCTYPE html>
<html>
<head>
<style>
table {
    text-align: center;
    border-collapse: collapse;
}
td, th {
    border: 1px solid #dddddd;
    padding: 8px;
}

</style>
<h1>Plan Based Report</h1>
<h4>Generated By:<br> {{$generated_by}}</h4><h4 style="position:absolute;left:520px;top:80px">Generated On: {{$generated_on}}</h4>
    <div style="position:absolute;left:520px;top:10px" class="cls_003">
        <img src="assets/images/smart_eclipse_logo.png" alt="Logo" height="30px" width="150px">
    </div>
</head>
<body>
@if(count($plan_based_details) != 0)
    <?php $plan_names = array_column(config('eclipse.PLANS'), 'NAME', 'ID'); ?>
    <h4 style="position:absolute;top:130px;bottom:30px;">Plan Type:<br> <?php ( $plan_type == null ) ? $plan_type = 'Freebies, Fundamental, Superior, Pro' : $plan_type = ucfirst(strtolower($plan_names[$plan_type])) ?>{{$plan_type}}</h4>
    <br><br><br>
    <h2 style="margin-left:250px;">Report Summary</h2>
    <table style="width: 100%;text-align: left;">
        <thead>
            <tr>
            <td><b>Plan Name</b></td>
            <td><b>Count</b></td>
            </tr>
        </thead>
        <tbody>
            @foreach($count_of_clients_under_plan as $each_data)
            <tr>
                <td><?php ( isset($each_data['name']) ) ? $client_name = $each_data['name'] : $client_name='-NA-' ?>{{$client_name}}</td>
                <td><b>{{$each_data['count']}}</b></td>
            </tr>
            @endforeach
        </tbody>
    </table>

    <br>
    <h2 style="margin-left:250px;">Report Details</h2>
    <h3 style="text-align: left;">End User Details</h3>

    <?php $i = 1; ?>
    @foreach($plan_based_details as $each_data)
    <h4 style="text-align: left;">#{{$i}}</h4>
    <table style="width:100%;text-align: left;">
        <tbody>
            <tr>
                <td><b>End User Name</b></td>
                <td style = "word-wrap: break-word;"><?php ( isset($each_data->client->name) ) ? $client_name = $each_data->client->name : $client_name='-NA-' ?>{{$client_name}}</td>
            </tr>
            <tr>
                <td><b>Plan</b></td>
                <td style = "word-wrap: break-word;"><?php ( isset($each_data->role) ) ? $role = ucfirst(strtolower($plan_names[$each_data->role])) : $role='-NA-' ?>{{$role}}</td>
            </tr>
<?php
if(isset($each_data->client->trader_id))
{
	
}
\Log::info($each_data->client);
 ?>
            @if($each_data->client->trader_id)
                <tr>
                    <td><b>Distributor Name</b></td>
                    <td style = "word-wrap: break-word;"><?php ( isset($each_data->client->trader->subDealer) ) ? $distributor_name = $each_data->client->trader->subDealer->dealer->name : $distributor_name='-NA-' ?>{{$distributor_name}}</td>
                </tr>
                <tr>
                    <td><b>Dealer Name</b></td>
                    <td style = "word-wrap: break-word;"><?php ( isset($each_data->client->trader->subDealer) ) ? $dealer_name = $each_data->client->trader->subDealer->name : $dealer_name='-NA-' ?>{{$dealer_name}}</td>
                </tr>
            @else
                <tr>
                    <td><b>Distributor Name</b></td>
                    <td style = "word-wrap: break-word;"><?php ( isset($each_data->client->subdealer) ) ? $distributor_name = $each_data->client->subdealer->dealer->name : $distributor_name='-NA-' ?>{{$distributor_name}}</td>
                </tr>
                <tr>
                    <td><b>Dealer Name</b></td>
                    <td style = "word-wrap: break-word;"><?php ( isset($each_data->client->subdealer) ) ? $dealer_name = $each_data->client->subdealer->name : $dealer_name='-NA-' ?>{{$dealer_name}}</td>
                </tr>
            @endif
            <tr>
                <td><b>Sub Dealer Name</b></td>
                <td style = "word-wrap: break-word;"><?php ( isset($each_data->client->trader->name) ) ? $sub_dealer_name = $each_data->client->trader->name : $sub_dealer_name='-NA-' ?>{{$sub_dealer_name}}</td>
            </tr>
        </tbody>
    </table>
    <?php $i++; ?>
    @endforeach
@endif

</body>
</html>

@section('script')
    <script src="{{asset('js/gps/mdb.js')}}"></script>
    <script src="{{asset('js/gps/gps-return-report-chart.js')}}"></script>
@endsection
